!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TweakpaneThumbnailListPlugin={})}(this,(function(t){"use strict";const e="tp";function i(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const s=t(i);return void 0!==s?{succeeded:!0,value:s}:{succeeded:!1,value:void 0}}}function s(t){return{custom:e=>i(e)(t),boolean:i((t=>"boolean"==typeof t?t:void 0))(t),number:i((t=>"number"==typeof t?t:void 0))(t),string:i((t=>"string"==typeof t?t:void 0))(t),function:i((t=>"function"==typeof t?t:void 0))(t),constant:e=>i((t=>t===e?e:void 0))(t),raw:i((t=>t))(t),object:e=>i((t=>{var i;if(null!==(i=t)&&"object"==typeof i)return function(t,e){return Object.keys(e).reduce(((i,s)=>{if(void 0===i)return;const n=(0,e[s])(t[s]);return n.succeeded?Object.assign(Object.assign({},i),{[s]:n.value}):void 0}),{})}(t,e)}))(t),array:e=>i((t=>{var i;if(Array.isArray(t))return i=e,t.reduce(((t,e)=>{if(void 0===t)return;const s=i(e);return s.succeeded&&void 0!==s.value?[...t,s.value]:void 0}),[])}))(t)}}const n={optional:s(!0),required:s(!1)};class o{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAA4klEQVR4Xu2awQ3EQAjEbjun9Ohq8ANZOP8JZDBstOL94DMzQ16xrX8k+b92+wNo/AyIAOgARXBbXwtAABqC2wjT+LVALQAdoAhu62sBCECnwDbCNH4tcL4FKEJ2/bN/AM0/A6iDdn0E2CtI848A6qBdHwH2CtL8I4A6aNdHgL2CNP8IoA7a9d0Inb8RygDoQDOgHaGWpNoSI2Nke4b0H0Cq155gi5JtirYfsD3FafxOgfOnAEXIru9KzF5Bmn8EUAft+giwV5DmHwHUQbs+AuwVpPlHAHXQro8AewVp/ucJ+AAX4sBQqPDC3AAAAABJRU5ErkJggg==",a=(l="thumb",(t,i)=>[e,"-",l,"v",t?`_${t}`:"",i?`-${i}`:""].join(""));var l;class u{constructor(t,e){this.optionEls_=[],this.onSelect_=this.onSelect_.bind(this),this.open_=this.open_.bind(this),this.close_=this.close_.bind(this),this.doc_=t,this.element=t.createElement("div"),this.element.classList.add(a()),this.selectEl_=document.createElement("div"),this.selectEl_.classList.add(a("sopt")),this.element.appendChild(this.selectEl_),this.selectThumbEl_=document.createElement("div"),this.selectThumbEl_.classList.add(a("sthmb")),this.selectEl_.appendChild(this.selectThumbEl_),this.selectLabelEl_=document.createElement("span"),this.selectLabelEl_.classList.add(a("slbl")),this.selectEl_.appendChild(this.selectLabelEl_),this.overlayEl_=t.createElement("div"),this.overlayEl_.classList.add(a("ovl")),this.element.appendChild(this.overlayEl_),this.selectEl_.addEventListener("click",this.open_),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.valueOptions_=e.valueOptions,this.init_(),this.refresh_(),e.viewProps.handleDispose((()=>{let t;for(this.selectEl_.removeEventListener("click",this.open_),this.doc_.removeEventListener("click",this.close_);t=this.optionEls_.pop();)t.removeEventListener("click",this.onSelect_),this.overlayEl_.removeChild(t)}))}init_(){const t=this.element.ownerDocument,e=e=>{const i=t.createElement("div");i.classList.add(a("thmb")),i.style.backgroundImage=e?`url(${e.src})`:`url(${r})`;const s=t.createElement("span");s.classList.add(a("lbl")),s.textContent=e?e.text:"None";const n=t.createElement("div");n.classList.add(a("opt")),n.appendChild(i),n.appendChild(s),n.setAttribute("data-value",e?e.value:""),n.addEventListener("click",this.onSelect_),this.optionEls_.push(n),this.overlayEl_.appendChild(n)};e(null);for(const t of this.valueOptions_)e(t)}refresh_(){const t=this.value_.rawValue;t?(this.selectThumbEl_.style.backgroundImage=`url(${t.src})`,this.selectLabelEl_.textContent=t.text):(this.selectThumbEl_.style.backgroundImage=`url(${r})`,this.selectLabelEl_.textContent="");const e=t?t.value:"";for(const t of this.optionEls_)t.getAttribute("data-value")===e?t.setAttribute("aria-selected","true"):t.removeAttribute("aria-selected")}open_(t){this.element.classList.add(a("-active")),this.doc_.addEventListener("click",this.close_),t.stopPropagation()}close_(){this.element.classList.remove(a("-active")),this.doc_.removeEventListener("click",this.close_)}onSelect_(t){const e=this.findOptionEl_(t.target).getAttribute("data-value"),i=this.valueOptions_.find((t=>t.value===e));this.value_.setRawValue(i||null)}findOptionEl_(t){for(;t&&!t.hasAttribute("data-value");)t=t.parentElement;if(!t)throw new Error("Invalid DOM scope");return t}onValueChange_(){this.refresh_()}}class h{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.viewProps.handleDispose((()=>{})),this.view=new u(t,{value:this.value,valueOptions:e.valueOptions,viewProps:this.viewProps})}}const d={id:"thumbnail-list",type:"input",css:".tp-thumbv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-thumbv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-thumbv:hover{background-color:var(--in-bg-h)}.tp-thumbv:focus{background-color:var(--in-bg-f)}.tp-thumbv:active{background-color:var(--in-bg-a)}.tp-thumbv:disabled{opacity:0.5}.tp-thumbv{--tptl-thumb-size: var(--tp-plugin-thumbnail-list-thumb-size, var(--bld-us));position:relative;height:var(--bld-us);cursor:pointer}.tp-thumbv,.tp-thumbv:hover{background:none}.tp-thumbv.tp-v-disabled{opacity:0.5}.tp-thumbv_ovl{z-index:100;box-shadow:0 2px 4px var(--bs-sh);display:none;position:absolute;top:var(--bld-us);right:0;overflow-x:hidden;overflow-y:auto;max-height:var(--tp-plugin-thumbnail-list-height, 400px);width:var(--tp-plugin-thumbnail-list-width, 200px);background:var(--bs-bg);padding:var(--cnt-v-p) var(--cnt-h-p);border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-thumbv_-active .tp-thumbv_ovl{display:block}.tp-thumbv_opt,.tp-thumbv_sopt{display:flex;flex-direction:row;color:var(--in-fg)}.tp-thumbv_sopt{height:var(--bld-us)}.tp-thumbv_opt{height:var(--tptl-thumb-size);margin:0 calc(-1 * var(--cnt-h-p));padding:var(--cnt-v-p) var(--cnt-h-p) 0;opacity:0.75}.tp-thumbv_opt[aria-selected]{opacity:1.0;background:var(--in-bg)}.tp-thumbv_opt:hover{opacity:1.0}.tp-thumbv_thmb,.tp-thumbv_sthmb{flex-shrink:0;width:var(--bld-us);height:100%;border-radius:var(--elm-br);background-size:contain;position:relative}.tp-thumbv_sthmb{width:var(--bld-us)}.tp-thumbv_thmb{margin-right:2em;width:var(--tptl-thumb-size)}[aria-selected] .tp-thumbv_thmb::after{content:'âœ“';position:absolute;right:-1em;font-size:1.5em;line-height:var(--tptl-thumb-size)}.tp-thumbv_lbl,.tp-thumbv_slbl{height:var(--bld-us);line-height:var(--bld-us);text-overflow:ellipsis}.tp-thumbv_slbl{margin-left:4px;padding:0 4px;background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;min-width:0;width:100%}.tp-thumbv_lbl{height:var(--tptl-thumb-size);line-height:var(--tptl-thumb-size)}",accept(t,e){if("string"!=typeof t)return null;const i=n,s=function(t,e){const i=n.required.object(e)(t);return i.succeeded?i.value:void 0}(e,{view:i.required.constant("thumbnail-list"),options:i.required.array(i.required.object({text:i.required.string,value:i.required.string,src:i.required.string,data:i.optional.custom((t=>t))}))});return s?{initialValue:t,params:s}:null},binding:{reader:t=>e=>t.params.options.find((t=>t.value===e))||null,constraint:t=>new o([]),writer:t=>(t,e)=>{t.write(e)}},controller:t=>new h(t.document,{value:t.value,valueOptions:t.params.options,viewProps:t.viewProps})};t.plugin=d,Object.defineProperty(t,"__esModule",{value:!0})}));
